(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[771],{5607:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/options",function(){return t(4913)}])},4913:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return n}});var s=t(2322),o=t(2784);function n(){let[e,r]=(0,o.useState)(""),[t,n]=(0,o.useState)(""),[l,a]=(0,o.useState)("http://localhost:3001"),[c,i]=(0,o.useState)(!1),[d,u]=(0,o.useState)("");(0,o.useEffect)(()=>{chrome.storage.sync.get(["openrouterKey","flomoApiUrl","serverUrl"],e=>{e.openrouterKey&&r(e.openrouterKey),e.flomoApiUrl&&n(e.flomoApiUrl),e.serverUrl&&a(e.serverUrl)})},[]);let m=async()=>{if(!e.trim()||!t.trim()){u("请填写所有必需的字段");return}i(!0),u("");try{await new Promise(r=>{chrome.storage.sync.set({openrouterKey:e.trim(),flomoApiUrl:t.trim(),serverUrl:l.trim()},()=>{r()})}),u("设置已保存！"),setTimeout(()=>u(""),3e3)}catch(e){console.error("Error saving settings:",e),u("保存失败，请重试")}finally{i(!1)}},p=async()=>{if(!e.trim()||!t.trim()||!l.trim()){u("请先填写并保存所有配置");return}try{let r=await fetch("".concat(l.trim(),"/api/test"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({openrouterKey:e.trim(),flomoApiUrl:t.trim()})});if(r.ok)u("配置测试成功！");else{let e=await r.json().catch(()=>({}));u("测试失败: ".concat(e.error||"服务器连接失败"))}}catch(e){console.error("Test error:",e),u("测试失败: ".concat(e.message))}};return(0,s.jsx)("div",{className:"extension-options p-8 bg-gray-50 min-h-screen",children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Flomo AI 笔记 - 设置"}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"OpenRouter API Key *"}),(0,s.jsx)("input",{type:"password",value:e,onChange:e=>r(e.target.value),placeholder:"请输入您的 OpenRouter API Key",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["在 ",(0,s.jsx)("a",{href:"https://openrouter.ai/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"OpenRouter"})," 获取您的API Key"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Flomo API URL *"}),(0,s.jsx)("input",{type:"url",value:t,onChange:e=>n(e.target.value),placeholder:"https://flomoapp.com/mine/?source=api",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"在 Flomo 设置中找到您的 API URL"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"服务器地址"}),(0,s.jsx)("input",{type:"url",value:l,onChange:e=>a(e.target.value),placeholder:"http://localhost:3001",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"后端服务的地址，默认为本地开发环境"})]}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{onClick:m,disabled:c,className:"px-6 py-2 rounded-md transition-colors ".concat(c?"bg-gray-400 text-gray-700 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"),children:c?"保存中...":"保存设置"}),(0,s.jsx)("button",{onClick:p,className:"px-6 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors",children:"测试配置"})]}),d&&(0,s.jsx)("div",{className:"p-3 rounded-md ".concat(d.includes("成功")||d.includes("已保存")?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:d})]}),(0,s.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-3",children:"使用说明"}),(0,s.jsxs)("ul",{className:"text-sm text-gray-600 space-y-2",children:[(0,s.jsx)("li",{children:"1. 配置您的 OpenRouter API Key 和 Flomo API URL"}),(0,s.jsx)("li",{children:"2. 在任意网页中选择想要总结的文本"}),(0,s.jsx)("li",{children:'3. 右键点击选择"总结flomo笔记"'}),(0,s.jsx)("li",{children:"4. AI 将自动总结内容并保存到您的 Flomo"})]})]})]})})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=5607)}),_N_E=e.O()}]);